<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Le Tr√©sor Public - Horizon Infini</title>
    <style>
        body, html { 
            margin: 0; height: 100%; width: 100%; 
            font-family: 'Comic Sans MS', cursive; 
            background: linear-gradient(to bottom, #87CEEB 0%, #FFFF00 100%);
            overflow: hidden; perspective: 1000px;
        }

        /* --- LE SOL DU JARDIN (ESPACE 3D) --- */
        #scene-3d {
            position: relative; width: 100%; height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.5s ease-out;
        }

        /* --- LES ENTIT√âS (FLEURS-MESSAGES) --- */
        .entite {
            position: absolute; background: white;
            padding: 20px; border-radius: 20px;
            border: 4px solid #008080;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: 0.5s; cursor: pointer;
            width: 200px; text-align: center;
        }
        .entite:hover { filter: brightness(1.2); z-index: 1000 !important; }
        
        /* Styles Profondeur */
        .loin { transform: translateZ(-500px) translateY(100px); opacity: 0.6; }
        .moyen { transform: translateZ(-200px) translateY(150px); opacity: 0.9; }
        .proche { transform: translateZ(100px) translateY(200px); border-color: #e91e63; }

        /* --- L'INTERFACE DE PILOTAGE --- */
        .interface {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 5000;
        }
        .btn-unite {
            position: absolute; bottom: 40px; right: 40px;
            width: 100px; height: 100px; background: gold;
            border-radius: 50%; border: none; font-size: 40px;
            cursor: pointer; pointer-events: auto;
            box-shadow: 0 0 30px rgba(255,215,0,0.6);
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { scale: 1; } 50% { scale: 1.1; } 100% { scale: 1; } }

        /* --- FIL DE CONNEXION --- */
        .lien-lumiere {
            position: absolute; background: gold; height: 2px;
            transform-origin: left center; opacity: 0; transition: 1s;
        }

        /* --- MENU DOCK --- */
        .dock {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); padding: 10px 40px; border-radius: 50px;
            display: flex; gap: 30px; pointer-events: auto;
        }
        .dock a { text-decoration: none; font-size: 30px; }
    </style>
</head>
<body>

    <div id="scene-3d">
        </div>

    <div class="interface">
        <h1 style="color: #000080; margin-top: 20px; pointer-events: auto;">üåå HORIZON DU TR√âSOR</h1>
        
        <button class="btn-unite" onmousedown="allumerFils()" onmouseup="eteindreFils()" title="Maintenir pour relier les c≈ìurs">ü§ù</button>

        <div class="dock">
            <a href="formulaire.html">üå±</a>
            <a href="jardin.html">üåª</a>
            <a href="regulation.html">‚öñÔ∏è</a>
            <a href="index.html">üè†</a>
        </div>
    </div>

    <script>
        const URL_GAS = "https://script.google.com/macros/s/AKfycbz4ncs9qw_AfmKSER5QST-P0OeKQggQaq86QC6liS53uZ9sx4Lo_-4-h1knXKWqgQMc/exec";
        
        // 1. G√âN√âRER LE JARDIN EN 3D
        fetch(URL_GAS).then(r => r.json()).then(data => {
            const scene = document.getElementById('scene-3d');
            data.reverse().forEach((item, index) => {
                const div = document.createElement('div');
                
                // On distribue selon le type (Urgence = Proche, Info = Loin)
                let profondeur = "moyen";
                if(item.type.toLowerCase().includes("urgence")) profondeur = "proche";
                if(item.type.toLowerCase().includes("paix") || index > 5) profondeur = "loin";
                
                div.className = `entite ${profondeur}`;
                div.style.left = (Math.random() * 60 + 20) + "%";
                div.style.top = (Math.random() * 20 + 10) + "%";
                
                div.innerHTML = `
                    <small>${item.type}</small>
                    <h4 style="margin:5px 0">${item.nom}</h4>
                    <p style="font-size:0.7em">${item.message.substring(0, 50)}...</p>
                `;
                scene.appendChild(div);
            });
        });

        // 2. PARALLAXE SOURIS (Bascule la sc√®ne)
        document.addEventListener('mousemove', (e) => {
            const rx = (window.innerHeight / 2 - e.clientY) / 30;
            const ry = (e.clientX - window.innerWidth / 2) / 30;
            document.getElementById('scene-3d').style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
        });

        // 3. FONCTION D'UNIT√â (LES FILS D'OR)
        function allumerFils() {
            const entites = document.querySelectorAll('.entite');
            entites.forEach(e => e.style.boxShadow = "0 0 50px gold");
            // Ici, on pourrait tracer des lignes SVG entre les blocs !
            alert("Les fils d'or se tissent... Vous reliez les citoyens.");
        }
        function eteindreFils() {
            const entites = document.querySelectorAll('.entite');
            entites.forEach(e => e.style.boxShadow = "0 10px 30px rgba(0,0,0,0.2)");
        }
    </script>
</body>
</html>
