<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Tr√©sor Public - Accueil</title>
    <style>
        body { font-family: 'Comic Sans MS', cursive; background-color: #FFFF00; color: #000080; margin: 0; text-align: center; }
        
        /* Menu */
        .menu-table { margin: 20px auto; background-color: #008080; border-radius: 15px; overflow: hidden; border-collapse: collapse; }
        .menu-table td { padding: 15px 20px; border: 1px solid white; }
        .menu-table a { text-decoration: none; color: white; font-weight: bold; }

        /* Pr√©sentation */
        .hero { padding: 30px; }
        .philosophie { 
            background: white; border: 4px solid #008080; border-radius: 40px; 
            padding: 25px; margin: 20px auto; max-width: 800px; font-style: italic; font-size: 1.3em;
            box-shadow: 10px 10px 0px #008080;
        }

        /* Formulaire Int√©gr√© avec Pays */
        .form-box { 
            background: white; border: 4px solid #e91e63; border-radius: 20px; 
            padding: 20px; max-width: 600px; margin: 30px auto; text-align: left;
        }
        select, input, textarea { 
            width: 100%; padding: 10px; margin: 10px 0; border-radius: 10px; 
            border: 2px solid #ccc; font-family: inherit; 
        }

        /* Moteur de Recherche */
        #searchBox { 
            width: 80%; max-width: 500px; padding: 15px; border: 4px solid #008080; 
            border-radius: 30px; font-size: 1.1em; margin: 20px 0;
        }

        /* Cartes d'activit√© */
        .carte { 
            background: white; margin: 15px auto; max-width: 700px; padding: 20px; 
            text-align: left; border-radius: 15px; border-left: 12px solid #008080;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <table class="menu-table" align="center">
        <tr>
            <td><a href="index.html">Accueil</a></td>
            <td><a href="formulaire.html">Semer üå±</a></td>
            <td><a href="jardin.html">Le Jardin üåª</a></td>
            <td><a href="regulation.html">R√©gulation ‚öñÔ∏è</a></td>
            <td><a href="urgence.html">Urgences üö®</a></td>
        </tr>
    </table>

    <div class="hero">
        <h1>Le Tr√©sor Public</h1>
        <div class="philosophie">
            "Ici, on s√®me tout ce qui est BON, on ne demande rien de pr√©cis, et on cultive la paix sans condamner."
        </div>
    </div>

    <input type="text" id="searchBox" oninput="ratisserLarge()" placeholder="üîç RATISSER LARGE : ville, pays, nom, message...">

    <div id="conteneur-vie">
        <p id="chargement">R√©cup√©ration des ondes positives du jardin...</p>
    </div>

    <script>
        const URL_SERVEUR = "https://script.google.com/macros/s/AKfycbz4ncs9qw_AfmKSER5QST-P0OeKQggQaq86QC6liS53uZ9sx4Lo_-4-h1knXKWqgQMc/exec";

        // 1. CHARGEMENT DES DONN√âES
        fetch(URL_SERVEUR)
            .then(res => res.json())
            .then(data => {
                const zone = document.getElementById('conteneur-vie');
                document.getElementById('chargement').style.display = 'none';

                data.reverse().forEach(item => {
                    if(item.type === "avis") return;

                    let couleur = "#008080";
                    if(item.type === "Urgence") couleur = "#e91e63";
                    if(item.type === "conflit") couleur = "#9370DB";

                    const div = document.createElement('div');
                    div.className = 'carte';
                    div.style.borderLeftColor = couleur;
                    div.innerHTML = `
                        <b style="color:${couleur}">${item.type.toUpperCase()}</b> - ${item.date}<br>
                        <b>${item.nom}</b> (${item.localisation})<br>
                        <p style="background:#f9f9f9; padding:10px; border-radius:10px; border:1px solid #eee;">
                            ${item.message}
                        </p>
                    `;
                    zone.appendChild(div);
                });
            });

        // 2. MOTEUR DE RECHERCHE "RATISSER LARGE"
        function ratisserLarge() {
            const filtre = document.getElementById('searchBox').value.toLowerCase();
            const cartes = document.getElementsByClassName('carte');

            for (let i = 0; i < cartes.length; i++) {
                const contenu = cartes[i].innerText.toLowerCase();
                // Si le texte de la carte contient la recherche, on affiche, sinon on cache
                cartes[i].style.display = contenu.includes(filtre) ? "block" : "none";
            }
        }
    </script>
</body>
</html>
