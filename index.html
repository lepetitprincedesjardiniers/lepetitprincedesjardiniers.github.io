<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Le Tr√©sor Public - Version Sismographe</title>
    <style>
        body { 
            font-family: 'Comic Sans MS', cursive; background-color: #FFFF00; 
            color: #000080; margin: 0; text-align: center; overflow-x: hidden;
        }

        /* --- LE SISMOGRAPHE (L'ACTIVIT√â) --- */
        #sismographe {
            position: fixed; bottom: 80px; left: 0; width: 100%; height: 60px;
            background: rgba(0, 128, 128, 0.1); border-top: 2px solid #008080;
            z-index: 100; pointer-events: none;
        }

        /* --- L'√âTOILE QUI TOURNE --- */
        .etoile-centrale {
            width: 200px; height: 200px; background: #9370DB;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            margin: 20px auto; animation: rotationDouce 20s linear infinite;
            display: flex; align-items: center; justify-content: center; color: white;
        }
        @keyframes rotationDouce { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* --- GRILLE DE RECHERCHE --- */
        .search-zone { padding: 20px; background: white; border-bottom: 5px solid #008080; }
        #barreRecherche { width: 60%; padding: 15px; border-radius: 30px; border: 3px solid #008080; }

        /* --- FLUX DE DONN√âES --- */
        .flux { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 40px; }
        .carte-mobile {
            background: white; border: 3px solid #008080; padding: 20px;
            width: 280px; border-radius: 20px; box-shadow: 10px 10px 0px #008080;
            transition: 0.3s;
        }
        .carte-mobile:hover { transform: scale(1.05); background: #f0ffff; }

        /* --- DOCK --- */
        .dock {
            position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%);
            background: #000; padding: 15px 40px; border-radius: 50px;
            display: flex; gap: 30px; z-index: 1000;
        }
        .dock a { font-size: 25px; text-decoration: none; }
    </style>
</head>
<body>

    <div class="search-zone">
        <input type="text" id="barreRecherche" placeholder="üîé Ratisser large dans les archives..." oninput="filtrer()">
    </div>

    <div class="etoile-centrale">
        <div style="transform: rotate(-0deg);">‚öñÔ∏è<br>PAIX</div>
    </div>

    <div class="flux" id="conteneur">
        </div>

    <canvas id="sismographe"></canvas>

    <div class="dock">
        <a href="index.html">üè†</a>
        <a href="formulaire.html">üå±</a>
        <a href="jardin.html">üåª</a>
        <a href="urgence.html">üö®</a>
    </div>

    <script>
        // 1. DESSINER LE SISMOGRAPHE
        const canvas = document.getElementById('sismographe');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        let points = [];

        function dessinerSismo() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.strokeStyle = "#008080";
            ctx.lineWidth = 2;
            
            points.push(Math.random() * 50);
            if(points.length > canvas.width / 5) points.shift();
            
            for(let i=0; i<points.length; i++) {
                ctx.lineTo(i * 5, 50 - points[i]);
            }
            ctx.stroke();
            requestAnimationFrame(dessinerSismo);
        }
        dessinerSismo();

        // 2. DONN√âES GOOGLE SHEETS
        const URL = "https://script.google.com/macros/s/AKfycbz4ncs9qw_AfmKSER5QST-P0OeKQggQaq86QC6liS53uZ9sx4Lo_-4-h1knXKWqgQMc/exec";
        fetch(URL).then(r => r.json()).then(data => {
            const conteneur = document.getElementById('conteneur');
            data.reverse().forEach(item => {
                const c = document.createElement('div');
                c.className = "carte-mobile";
                c.innerHTML = `<b>${item.nom}</b><br><small>${item.type}</small><p>${item.message}</p>`;
                conteneur.appendChild(c);
            });
        });

        function filtrer() {
            const val = document.getElementById('barreRecherche').value.toLowerCase();
            const cartes = document.getElementsByClassName('carte-mobile');
            for(let c of cartes) {
                c.style.display = c.innerText.toLowerCase().includes(val) ? "block" : "none";
            }
        }
    </script>
</body>
</html>
