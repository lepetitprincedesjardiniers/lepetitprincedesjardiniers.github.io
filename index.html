<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Tr√©sor Public - Accueil Valid√©</title>
    <style>
        /* Design Global */
        body { 
            font-family: 'Comic Sans MS', cursive; 
            text-align: center; 
            margin: 0; 
            padding: 0; 
            background-color: #FFFF00; 
            color: #000080; 
            overflow-x: hidden; 
            min-height: 100vh; 
        }

        /* Styles des √©l√©ments existants */
        #google_translate_element { padding: 10px; background: rgba(255,255,255,0.5); border-bottom: 1px solid #008080; }
        .menu-table { margin: 20px auto; border-radius: 10px; background-color: #008080; border-collapse: collapse; margin-left: auto; margin-right: auto; }
        .menu-table td { padding: 10px 15px; border: 1px solid #FFFFFF; }
        .menu-table a { text-decoration: none; color: #FFFFFF; font-weight: bold; }
        
        .soleil-don {
            background: #FFD700; width: 250px; height: 250px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 50px #FFA500; border: 5px dashed #FF4500;
            margin: 30px auto; cursor: pointer; transition: 0.4s;
            text-decoration: none; color: #000080; font-weight: bold;
        }

        .bulles-grid { display: flex; justify-content: center; align-items: center; gap: 25px; flex-wrap: wrap; padding: 20px; }
        .nuage { background: #e0f7fa; border: 3px solid #008080; border-radius: 50px; padding: 20px; width: 300px; min-height: 200px; text-decoration: none; color: inherit; display: flex; flex-direction: column; justify-content: center; transition: 0.3s; }
        .nuage-rose { background: #ffebee; border-color: #e91e63; }
        .etoile-justice { background: #E6E6FA; border: 3px solid #9370DB; width: 350px; height: 350px; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); transition: 0.5s; cursor: pointer; text-decoration: none; color: inherit; display: flex; align-items: center; justify-content: center; }
        .exemples { font-size: 0.85em; color: #2E7D32; font-style: italic; margin-top: 10px; font-weight: bold; }

        /* ANIMAUX ET CADEAU */
        .animal-container { position: fixed; z-index: 900; pointer-events: none; display: flex; align-items: center; }
        .bulle-texte { background: white; border: 2px solid #2E7D32; border-radius: 15px; padding: 8px 15px; font-weight: bold; opacity: 0; max-width: 250px; }
        #coffre-magique { position: fixed; font-size: 60px; z-index: 800; pointer-events: none; transition: transform 0.2s; }
        .pop { transform: scale(1.6) !important; }
        .confetti { position: fixed; z-index: 999; pointer-events: none; animation: fly 2s forwards; }
        @keyframes fly { 0% { transform: translate(0,0); opacity: 1; } 100% { transform: translate(var(--dx), var(--dy)); opacity: 0; } }

        /* --- SYST√àME DE TRANSITION COEUR --- */
        #overlay-coeur {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none; /* Cach√© par d√©faut */
            flex-direction: column; justify-content: center; align-items: center;
            z-index: 2000;
        }

        .big-heart {
            font-size: 15em; color: #FF1493;
            animation: heartbeat 1.2s infinite alternate, multicolor 3s linear infinite;
        }

        @keyframes heartbeat { from { transform: scale(1); } to { transform: scale(1.15); } }
        @keyframes multicolor {
            0% { color: #FF1493; } 25% { color: #9400D3; } 50% { color: #00BFFF; } 75% { color: #32CD32; } 100% { color: #FF1493; }
        }

        /* Coeurs et animaux de transition */
        .trans-element { position: absolute; font-size: 3em; animation: flyToCenter 2.5s ease-out forwards; }
        @keyframes flyToCenter {
            0% { transform: translate(var(--sx), var(--sy)) scale(0); opacity: 0; }
            20% { opacity: 1; scale(1); }
            100% { transform: translate(0, 0) scale(0); opacity: 0; }
        }

        footer { margin: 60px 0 20px; font-size: 0.9em; }
    </style>
</head>
<body>

    <div id="google_translate_element"></div>
    <script>function googleTranslateElementInit() { new google.translate.TranslateElement({pageLanguage: 'fr'}, 'google_translate_element'); }</script>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <audio id="chantOiseaux" loop><source src="oiseaux.mp3" type="audio/mpeg"></audio>

    <div id="overlay-coeur">
        <div class="big-heart">‚ù§Ô∏è</div>
        <h2 style="color: #FF1493;">Vibration en cours...</h2>
    </div>

    <table class="menu-table">
        <tr>
            <td><a href="index.html">Accueil</a></td>
            <td><a href="formulaire.html">Semer</a></td>
            <td><a href="jardin.html">Le Jardin</a></td>
            <td><a href="contact.html">Contact</a></td>
        </tr>
    </table>

    <h1>üíê Le Tr√©sor Public</h1>
    <p><strong>Le Petit Prince des Jardiniers</strong></p>

    <a href="formulaire.html" class="soleil-don">
        <div>‚òÄÔ∏è<br>ESPACE DU DON ENTIER<br><span style="font-weight:normal; font-size:0.8em;">Cadeau sans retour attendu</span></div>
    </a>

    <div class="bulles-grid">
        <a href="impot.html" class="nuage">
            <h3 style="color:#008080; margin:0; text-transform:uppercase;">üìú Imp√¥t Public</h3>
            <p>Travaux publics en libre participation.</p>
            <div class="exemples">Ex : Nettoyage bois communal, t√¢ches administratives...</div>
        </a>

        <a href="regulation.html" class="etoile-justice">
            <div style="width:70%;"><h3>‚öñÔ∏è R√©gulation Citoyenne</h3><p>Justice avec d√©licatesse.</p></div>
        </a>

        <a href="urgence.html" class="nuage nuage-rose">
            <h3 style="color:#e91e63; margin:0;">‚ù§Ô∏è Urgence & √âcoute</h3>
            <p>Besoins vitaux et aide aux projets.</p>
        </a>
    </div>

    <div id="coffre-magique">üéÅ</div>

    <footer><p>¬© 2000 <a href="https://www.youtube.com/channel/UCjsudx7f1sl7XQM8ylcBRdQ" target="_blank">Le petit prince des jardiniers</a></p></footer>

    <script>
        // --- LOGIQUE DE LA TRANSITION ---
        const overlay = document.getElementById('overlay-coeur');
        const animalsEmoji = ['üïäÔ∏è', 'ü¶ã', 'üêù', 'üêû', '‚ù§Ô∏è', 'üíñ'];

        document.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', function(e) {
                const targetUrl = this.href;
                
                // Si c'est un lien interne, on lance l'animation
                if (targetUrl.includes('.html') && !targetUrl.includes('index.html#')) {
                    e.preventDefault(); 
                    overlay.style.display = 'flex';
                    
                    // Cr√©er des animaux/coeurs qui convergent
                    for(let i=0; i<15; i++) {
                        setTimeout(() => {
                            const el = document.createElement('div');
                            el.className = 'trans-element';
                            el.innerText = animalsEmoji[Math.floor(Math.random()*animalsEmoji.length)];
                            const angle = Math.random() * Math.PI * 2;
                            const dist = 400;
                            el.style.setProperty('--sx', Math.cos(angle)*dist + 'px');
                            el.style.setProperty('--sy', Math.sin(angle)*dist + 'px');
                            overlay.appendChild(el);
                            setTimeout(() => el.remove(), 2500);
                        }, i * 150);
                    }

                    // Redirection apr√®s 3 secondes
                    setTimeout(() => { window.location.href = targetUrl; }, 3500);
                }
            });
        });

        // --- LOGIQUE DES MESSAGERS (Limit√©e √† 3 passages) ---
        const basePhrases = ["L'Imp√¥t Public est un geste de c≈ìur", "T√¢ches n√©cessaires", "Besoin d'aide administrative ?", "Graines de g√©n√©rosit√©", "Le pardon est justice", "Besoin d'un c√¢lin", "Farine pour le pain"];
        let disponibles = [...basePhrases];
        const typesAnimaux = ['üïäÔ∏è', 'ü¶ã', 'üêù', 'üêû'];
        const fleurs = ['üå∏', 'üåº', 'üåª', 'üå∫'];
        const messagers = [];
        const coffre = document.getElementById('coffre-magique');
        let coffreX = window.innerWidth / 2, coffreY = window.innerHeight + 100;
        let passages = 0;

        document.addEventListener('click', () => { 
            const a = document.getElementById('chantOiseaux');
            if(a.paused) { a.volume = 0.05; a.play(); } 
        });

        function createConfetti(x, y) {
            for(let i=0; i<20; i++) {
                const c = document.createElement('div');
                c.className = 'confetti';
                c.innerText = fleurs[Math.floor(Math.random()*4)];
                c.style.left = x+"px"; c.style.top = y+"px";
                c.style.setProperty('--dx', (Math.random()*400-200)+"px");
                c.style.setProperty('--dy', (Math.random()*400-200)+"px");
                document.body.appendChild(c);
                setTimeout(() => c.remove(), 2000);
            }
        }

        function createMessenger() {
            if (passages >= 3 || messagers.length > 0 || disponibles.length === 0) return;
            let start = {x:-200, y:Math.random()*window.innerHeight};
            const txt = disponibles.splice(Math.floor(Math.random()*disponibles.length), 1)[0];
            const div = document.createElement('div');
            div.className = "animal-container";
            div.innerHTML = `<div class="bulle-texte" style="width:0px">${txt}</div><div style="font-size:50px">${typesAnimaux[Math.floor(Math.random()*4)]}</div>`;
            document.body.appendChild(div);

            messagers.push({
                el: div, bulle: div.firstChild, texte: txt,
                x: start.x, y: start.y, tx: 200+Math.random()*(window.innerWidth-400), ty: 200+Math.random()*(window.innerHeight-400),
                state: "IN", seed: Math.random()*1000
            });
        }

        function loop() {
            let target = null;
            for (let i = messagers.length-1; i>=0; i--) {
                let m = messagers[i];
                if(m.state === "IN") {
                    target = m;
                    m.x += (m.tx-m.x)*0.015; m.y += (m.ty-m.y)*0.015;
                    m.bulle.style.opacity = 1;
                    let w = parseInt(m.bulle.style.width)||0;
                    if(w<220) m.bulle.style.width = (w+2)+"px";
                    if(Math.abs(m.tx-m.x)<30) {
                        m.state="WAIT"; createConfetti(m.x, m.y); coffre.classList.add('pop');
                        setTimeout(() => { 
                            m.state="OUT"; coffre.classList.remove('pop');
                            m.bulle.style.opacity=0; m.tx = window.innerWidth+300;
                            passages++;
                        }, 4000);
                    }
                } else if(m.state === "OUT") {
                    m.x += (m.tx-m.x)*0.02; m.y += (m.ty-m.y)*0.02;
                    if(m.x>window.innerWidth+250) { m.el.remove(); messagers.splice(i,1); }
                }
                m.el.style.left = m.x+"px"; m.el.style.top = (m.y + Math.sin(Date.now()*0.005+m.seed)*15)+"px";
            }
            if(target) { coffreX+=(target.x-coffreX)*0.06; coffreY+=(target.y+40-coffreY)*0.06; }
            else { coffreX+=(window.innerWidth/2-coffreX)*0.02; coffreY+=(window.innerHeight+100-coffreY)*0.02; }
            coffre.style.left = coffreX+"px"; coffre.style.top = coffreY+"px";
            requestAnimationFrame(loop);
        }
        setInterval(createMessenger, 3000); 
        createMessenger(); 
        loop();
    </script>
</body>
</html>
