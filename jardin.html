<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Le Jardin des Annonces - Le Petit Prince</title>
    <style>
        body { background-color: #FFFF00; color: #000080; font-family: "Comic Sans MS", cursive; text-align: center; margin: 0; }
        nav { background-color: #008080; padding: 10px; margin-bottom: 20px; }
        nav a { color: white; text-decoration: none; margin: 0 15px; font-weight: bold; }
        #barreRecherche { width: 80%; max-width: 400px; padding: 12px; margin: 20px 0; border: 3px solid #008080; border-radius: 10px; }
        .annonce { background: white; border: 2px solid #000080; margin: 15px auto; padding: 15px; width: 85%; max-width: 600px; text-align: left; border-radius: 15px; }
        .titre { color: #FF0000; font-weight: bold; font-size: 1.2em; }
        .ville { color: #008080; font-weight: bold; }
    </style>
</head>
<body onload="charger()">
    <nav>
        <a href="index.html">Accueil</a>
        <a href="formulaire.html">Espace Don</a>
        <a href="jardin.html">Le Jardin</a>
        <a href="contact.html">Contact</a>
    </nav>

    <font size="6" color="#FF0000"><u><b>LE JARDIN DES CADEAUX</b></u></font><br>
    
    <input type="text" id="barreRecherche" placeholder="üîç Chercher une ville, un don, un nom..." onkeyup="filtrer()">

    <div id="status">Chargement des graines...</div>
    <div id="liste"></div>

    <script>
        const url = "https://script.google.com/macros/s/AKfycbwe3bMzbJMUQSEdeyprffw-FQpqLg9-fGcHJi2_1_Ix5kWmrisBoSo2Kzne-CMwe3s/exec";
        let annonces = [];

        async function charger() {
            try {
                const res = await fetch(url);
                annonces = await res.json();
                document.getElementById('status').style.display = 'none';
                afficher(annonces);
            } catch (e) { document.getElementById('status').innerText = "Erreur de connexion au jardin."; }
        }

        function afficher(data) {
            const div = document.getElementById('liste');
            div.innerHTML = "";
            data.reverse().forEach(a => {
                div.innerHTML += `<div class="annonce">
                    <span class="titre">üåø Graine de ${a.prenom}</span><br>
                    <span class="ville">üìç ${a.ville} (${a.km} km)</span>
                    <p>${a.description}</p>
                    <small>Post√© le : ${new Date(a.date).toLocaleDateString()} | Dur√©e : ${a.duree}</small>
                </div>`;
            });
        }

        function filtrer() {
            const mot = document.getElementById('barreRecherche').value.toLowerCase();
            const res = annonces.filter(a => 
                a.ville.toLowerCase().includes(mot) || 
                a.description.toLowerCase().includes(mot) || 
                a.prenom.toLowerCase().includes(mot)
            );
            afficher(res);
        }
    </script>
</body>
</html>
