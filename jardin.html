<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Le Jardin des Annonces - Le Petit Prince</title>
    <style>
        body { background-color: #FFF8E1; color: #2E7D32; font-family: "Comic Sans MS", cursive, sans-serif; text-align: center; padding: 20px; }
        .bouton-retour { display: inline-block; margin-bottom: 25px; color: #4CAF50; text-decoration: none; font-weight: bold; border: 2px solid #4CAF50; padding: 10px 20px; border-radius: 20px; background-color: white; }
        h1 { color: #2E7D32; text-decoration: underline; }
        
        /* Barre de recherche */
        #barreRecherche { 
            width: 80%; max-width: 400px; padding: 12px; margin-bottom: 30px; 
            border: 2px solid #4CAF50; border-radius: 10px; font-size: 16px;
        }

        #listeAnnonces { display: flex; flex-direction: column; align-items: center; gap: 15px; }
        
        .annonce { 
            background-color: white; border: 2px solid #A5D6A7; padding: 15px; 
            width: 90%; max-width: 500px; border-radius: 15px; text-align: left;
            transition: 0.3s;
        }
        .annonce:hover { transform: scale(1.02); border-color: #4CAF50; }
        
        .titre-annonce { color: #2E7D32; font-weight: bold; font-size: 1.1em; display: block; border-bottom: 1px dotted #A5D6A7; margin-bottom: 5px; }
        .ville-annonce { color: #E91E63; font-size: 0.9em; font-weight: bold; }
        .description { color: #555; margin-top: 5px; font-family: sans-serif; }
    </style>
</head>
<body>

    <a href="https://lepetitprincedesjardiniers.github.io/" class="bouton-retour">‚¨Ö Retour √† l'accueil</a>
    
    <h1>üåª Le Jardin des Annonces</h1>
    
    <input type="text" id="barreRecherche" placeholder="Rechercher une ville ou une graine..." onkeyup="filtrerAnnonces()">

    <div id="chargement">Le jardin fleurit...</div>
    <div id="listeAnnonces"></div>

    <script>
        const urlScript = "https://script.google.com/macros/s/AKfycbxuILkBo4L8JIK6ks1XsLpWMxvcviXSyMekJZI_sz-L_hRJygEDAoSVSzZ526DvsnTN/exec";
        let toutesLesAnnonces = [];

        async function chargerAnnonces() {
            try {
                const response = await fetch(urlScript);
                toutesLesAnnonces = await response.json();
                document.getElementById('chargement').style.display = 'none';
                afficher(toutesLesAnnonces);
            } catch (e) { document.getElementById('chargement').innerText = "Erreur de chargement."; }
        }

        function afficher(liste) {
            const conteneur = document.getElementById('listeAnnonces');
            conteneur.innerHTML = "";
            liste.reverse().forEach(a => {
                const div = document.createElement('div');
                div.className = 'annonce';
                div.innerHTML = `
                    <span class="titre-annonce">üåø Graine de ${a.identifiant}</span>
                    <span class="ville-annonce">üìç ${a.ville}</span>
                    <p class="description">${a.description}</p>
                    <small>üí¨ Contact : ${a.contact}</small>
                `;
                conteneur.appendChild(div);
            });
        }

        function filtrerAnnonces() {
            const mot = document.getElementById('barreRecherche').value.toLowerCase();
            const filtre = toutesLesAnnonces.filter(a => 
                a.ville.toLowerCase().includes(mot) || 
                a.description.toLowerCase().includes(mot) ||
                a.identifiant.toLowerCase().includes(mot)
            );
            afficher(filtre);
        }

        chargerAnnonces();
    </script>
</body>
</html>
