<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urgences & Imp√¥t Volontaire - Le Tr√©sor Public</title>
    <style>
        /* TON IDENTIT√â VISUELLE HISTORIQUE */
        body { 
            font-family: 'Comic Sans MS', cursive, sans-serif; 
            background-color: #FFFF00; 
            color: #000080; 
            margin: 0; 
            padding: 0; 
            text-align: center; 
        }

        /* LE TRADUCTEUR GOOGLE */
        #google_translate_element { 
            padding: 10px; 
            background: rgba(255,255,255,0.5); 
            border-bottom: 2px solid #008080; 
        }

        /* LE MENU DE NAVIGATION */
        .menu-table { 
            margin: 20px auto; 
            background-color: #008080; 
            border-collapse: collapse; 
            border-radius: 10px;
            overflow: hidden;
        }
        .menu-table td { padding: 12px 20px; border: 1px solid #FFFFFF; }
        .menu-table a { text-decoration: none; color: #FFFFFF; font-weight: bold; }
        .menu-table a:hover { color: #FFFF00; }

        /* LE CONTENEUR DU FORMULAIRE D'URGENCE */
        .form-container { 
            background: white; 
            border: 5px solid #e91e63; /* Rose/Rouge pour l'urgence */
            border-radius: 30px; 
            width: 90%; 
            max-width: 650px; 
            margin: 30px auto; 
            padding: 25px;
            box-shadow: 10px 10px 0px #e91e63;
        }

        h1 { color: #e91e63; text-shadow: 1px 1px 2px #000; }
        
        label { display: block; margin-top: 15px; font-weight: bold; text-align: left; }
        
        input, textarea, select { 
            width: 100%; 
            padding: 12px; 
            margin: 8px 0; 
            border-radius: 12px; 
            border: 2px solid #e91e63; 
            box-sizing: border-box; 
            font-family: inherit;
            font-size: 1em;
        }

        .btn-envoi { 
            background: #e91e63; 
            color: white; 
            border: none; 
            padding: 18px 40px; 
            border-radius: 25px; 
            font-weight: bold; 
            cursor: pointer; 
            font-size: 1.3em; 
            margin-top: 20px;
            transition: transform 0.2s;
        }
        .btn-envoi:hover { transform: scale(1.05); background: #c2185b; }
        .btn-envoi:disabled { background: #ccc; cursor: not-allowed; }

        .quote { font-style: italic; margin: 20px; color: #008080; }
    </style>
</head>
<body>

    <div id="google_translate_element"></div>
    <script type="text/javascript">
        function googleTranslateElementInit() { 
            new google.translate.TranslateElement({pageLanguage: 'fr'}, 'google_translate_element'); 
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <table class="menu-table">
        <tr>
            <td><a href="index.html">Accueil</a></td>
            <td><a href="formulaire.html">Semer</a></td>
            <td><a href="jardin.html">Le Jardin</a></td>
            <td><a href="urgence.html">Urgences</a></td>
        </tr>
    </table>

    <h1>üì¢ Appels du C≈ìur & Urgences</h1>
    <p class="quote">"On ne voit bien qu'avec le c≈ìur. L'essentiel est invisible pour les yeux."</p>

    <div class="form-container">
        <form id="urgencyForm">
            <label>Quelle est la nature de ton message ?</label>
            <select id="type">
                <option value="Urgence">‚ù§Ô∏è URGENCE VITALE (Besoin d'aide)</option>
                <option value="Imp√¥t">üìú IMP√îT VOLONTAIRE (Offre de temps/travail)</option>
            </select>

            <label>Ton Identit√© (Nom ou Pseudo) :</label>
            <input type="text" id="nom" placeholder="Ex: Le Petit Prince" required>

            <label>O√π te trouves-tu ? (Ville/R√©gion) :</label>
            <input type="text" id="ville" placeholder="Ex: Plan√®te B612 ou Lyon, France" required>

            <label>Ton Message pour la Communaut√© :</label>
            <textarea id="message" rows="6" placeholder="D√©cris ici ton besoin urgent ou ce que tu souhaites offrir au tr√©sor public..." required></textarea>

            <button type="submit" id="btnEnvoi" class="btn-envoi">LANCER L'APPEL üöÄ</button>
        </form>
    </div>

    <p><a href="index.html" style="color: #000080; font-weight: bold; text-decoration: none;">‚Üê Retourner √† la source (Accueil)</a></p>

    <script>
        // Ton URL de script Google Apps Script
        const URL_SERVEUR = "https://script.google.com/macros/s/AKfycbz4ncs9qw_AfmKSER5QST-P0OeKQggQaq86QC6liS53uZ9sx4Lo_-4-h1knXKWqgQMc/exec";

        document.getElementById('urgencyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('btnEnvoi');
            btn.innerText = "Transmission vers le Jardin...";
            btn.disabled = true;

            // On pr√©pare la donn√©e pour ton Google Sheet
            const donnees = {
                date: new Date().toLocaleDateString('fr-FR'),
                type: document.getElementById('type').value,
                nom: document.getElementById('nom').value,
                localisation: document.getElementById('ville').value,
                message: document.getElementById('message').value
            };

            // Envoi des donn√©es (Chemin B)
            fetch(URL_SERVEUR, {
                method: 'POST',
                mode: 'no-cors', // Sp√©cifique √† Google Apps Script
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(donnees)
            }).then(() => {
                alert("Ton message a bien √©t√© transmis au Jardin Collectif.");
                window.location.href = "jardin.html"; // Redirection automatique
            }).catch(err => {
                alert("Une erreur est survenue lors de l'envoi.");
                btn.disabled = false;
                btn.innerText = "LANCER L'APPEL üöÄ";
            });
        });
    </script>
</body>
</html>
